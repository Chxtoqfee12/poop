local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- ‡πÇ‡∏´‡∏•‡∏î Rayfield
local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/Chxtoqfee12/script-admin-chx/refs/heads/main/chx.lib'))()

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á Window
local Window = Rayfield:CreateWindow({
    Name = "üí© Auto Farm UI",
    LoadingTitle = "‡∏≠‡∏≠‡πÇ‡∏ï‡πâ‡∏Ç‡∏∂‡πâ ",
    LoadingSubtitle = "By ‡∏≠‡∏µ‡∏´‡∏ô‡∏∂‡πà‡∏á",
})

----------------------------------------------------
-- Tab Auto Poop
----------------------------------------------------
local poopTab = Window:CreateTab("Auto Poop", "zap")

local autoPoop = false
local autoDrop = false
local poopSpeed = 1
local lbThreshold = 5

-- Slider Poop Speed
poopTab:CreateSlider({
    Name = "Poop Speed (sec)",
    Range = {0.3,5},
    Increment = 0.1,
    Suffix = "s",
    CurrentValue = 1,
    Flag = "PoopSpeed",
    Callback = function(Value)
        poopSpeed = Value
    end,
})

-- Slider LB Threshold
poopTab:CreateSlider({
    Name = "LB Threshold",
    Range = {1,50},
    Increment = 1,
    Suffix = "lbs",
    CurrentValue = lbThreshold,
    Flag = "LBThreshold",
    Callback = function(Value)
        lbThreshold = Value
    end,
})

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á lb ‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°
local function getLBFromName(itemName)
    local lbStr = itemName:match("%(([%d%.]+) lbs%)")
    if lbStr then return tonumber(lbStr) end
    return nil
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ñ‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ lb
local function checkAndDropItem(item)
    local lb = getLBFromName(item.Name)
    if lb and lb < lbThreshold then
        -- ‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ Character
        item.Parent = player.Character
        task.wait(0.05)

        -- ‡∏ñ‡∏∑‡∏≠‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°‡∏î‡πâ‡∏ß‡∏¢ Remote SetToolGrip
        if ReplicatedStorage:FindFirstChild("SetToolGrip") then
            local args = {item, CFrame.new(0,0,0)} -- ‡πÉ‡∏ä‡πâ CFrame ‡∏ï‡∏≤‡∏° Remote Spy
            ReplicatedStorage.SetToolGrip:FireServer(unpack(args))
            task.wait(0.1)
        end

        -- ‡∏ó‡∏¥‡πâ‡∏á‡∏î‡πâ‡∏ß‡∏¢ Remote DropItem ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏°
        if ReplicatedStorage:FindFirstChild("DropItem") then
            ReplicatedStorage.DropItem:FireServer(item)
        end
    end
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Backpack
local function dropLowLBItems()
    local backpack = player:FindFirstChild("Backpack")
    if backpack then
        for _, item in pairs(backpack:GetChildren()) do
            checkAndDropItem(item)
        end
    end
end

-- Toggle Auto Poop
poopTab:CreateToggle({
    Name = "Enable Auto Poop",
    CurrentValue = false,
    Flag = "AutoPoop",
    Callback = function(Value)
        autoPoop = Value
        if autoPoop then
            task.spawn(function()
                while autoPoop do
                    ReplicatedStorage:WaitForChild("PoopChargeStart"):FireServer()
                    task.wait(0.2)
                    ReplicatedStorage:WaitForChild("PoopEvent"):FireServer(1)
                    task.wait(poopSpeed)
                end
            end)
        end
    end,
})

-- Toggle Auto Drop (‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å Poop)
poopTab:CreateToggle({
    Name = "Enable Auto Drop Low LB Items",
    CurrentValue = false,
    Flag = "AutoDrop",
    Callback = function(Value)
        autoDrop = Value
        if autoDrop then
            task.spawn(function()
                while autoDrop do
                    dropLowLBItems()
                    task.wait(0.5) -- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å 0.5 ‡∏ß‡∏¥
                end
            end)
        end
    end,
})
